---
title: "Coeffcient Investigation"
author: "Daivd Leslie"
date: "Sunday, April 12, 2015"
output: pdf_document
---
* This code assumes an array filled with spatially autocorrelated data has already been generated.

Now that the data has been generated, let's see how the accurary of the model coeffcients changes as the spatail range increases (Remebering that they should be close to the exspected values of: x1=2, x2=1, and x3=3).

```{r}
# Load data
load("~/R/EVSS695/spatial_cv/resultsVarStagScaleStep.Rdata")

# Must match numMat from generated data
numMat = 100

# Must match numReps from generated data
numReps = 10

# ust match spat_range from generated data
spat_range =  seq(0.001, 60, length.out=numMat)

# ust match var_range from generated data
var_range = 1:10

# Set numbers of colmns in coeffcients array
numColsCoef = 5

# Create arrary filled with coeffcient values
coefVals = array(NA, dim=c(numMat, numColsCoef, numReps), dimnames = list(1:numMat,c('x1_dif', 'x2_dif', 'x3_dif', 'spat_range', 'var_range'), NULL))

# Fill  array with coeffcient values
for(i in 1:numReps) {
 for(j in 1:numMat) {
  model = glm(y ~ x1 + x2 + x3, data = as.data.frame(resultsArray[,,j,i]))
  coefVals[j, 1, i] = 2 - coef(model)[2]
  coefVals[j, 2, i] = 1 - coef(model)[3]
  coefVals[j, 3, i] = 3 - coef(model)[4]
  coefVals[j, 4, i] = spat_range[j]
  coefVals[j, 5, i] = var_range[i]
  } 
}

# Check array
head(coefVals[,,1])
head(coefVals[,,5])
head(coefVals[,,10])
```

# X1 Coeffcient Difference Plots
```{r, echo=FALSE}
# Plot accuracy of coeffcients
# Set margins
par( mfrow = c(2, 2))

plot(coefVals[, 4, 1], coefVals[, 1, 1], type='o')
abline(lm(coefVals[, 1, 1] ~ coefVals[, 4, 1]))

plot(coefVals[, 4, 2], coefVals[, 1, 2], type='o')
abline(lm(coefVals[, 1, 2] ~ coefVals[, 4, 2]))

plot(coefVals[, 4, 3], coefVals[, 1, 3], type='o')
abline(lm(coefVals[, 1, 3] ~ coefVals[, 4, 3]))

plot(coefVals[, 4, 4], coefVals[, 1, 4], type='o')
abline(lm(coefVals[, 1, 4] ~ coefVals[, 4, 4]))

# Set margins
par( mfrow = c(2, 2))

plot(coefVals[, 4, 5], coefVals[, 1, 5], type='o')
abline(lm(coefVals[, 1, 5] ~ coefVals[, 4, 5]))
  
plot(coefVals[, 4, 6], coefVals[, 1, 6], type='o')
abline(lm(coefVals[, 1, 6] ~ coefVals[, 4, 6]))
  
plot(coefVals[, 4, 7], coefVals[, 1, 7], type='o')
abline(lm(coefVals[, 1, 7] ~ coefVals[, 4, 7]))
  
plot(coefVals[, 4, 8], coefVals[, 1, 8], type='o')
abline(lm(coefVals[, 1, 8] ~ coefVals[, 4, 8]))

# Set margins
par( mfrow = c(2, 2))

plot(coefVals[, 4, 9], coefVals[, 1, 9], type='o')
abline(lm(coefVals[, 1, 9] ~ coefVals[, 4, 9]))
  
plot(coefVals[, 4, 10], coefVals[, 1, 10], type='o')
abline(lm(coefVals[, 1, 10] ~ coefVals[, 4, 10]))

```

# X2 Coeffcient Difference Plots
```{r, echo=FALSE}
# Plot accuracy of coeffcients
# Set margins
par( mfrow = c(2, 2))
plot(coefVals[, 4, 1], coefVals[,2, 1], type='o')
abline(lm(coefVals[, 2, 1] ~ coefVals[, 4, 1]))

plot(coefVals[, 4, 2], coefVals[, 2, 2], type='o')
abline(lm(coefVals[, 2, 2] ~ coefVals[, 4, 2]))

plot(coefVals[, 4, 3], coefVals[, 2, 3], type='o')
abline(lm(coefVals[, 2, 3] ~ co
          efVals[, 4, 3]))

plot(coefVals[, 4, 4], coefVals[, 1, 4], type='o')
abline(lm(coefVals[, 1, 4] ~ coefVals[, 4, 4]))

# Set margins
par( mfrow = c(2, 2))

plot(coefVals[, 4, 5], coefVals[, 1, 5], type='o')
abline(lm(coefVals[, 1, 5] ~ coefVals[, 4, 5]))
  
plot(coefVals[, 4, 6], coefVals[, 1, 6], type='o')
abline(lm(coefVals[, 1, 6] ~ coefVals[, 4, 6]))
  
plot(coefVals[, 4, 7], coefVals[, 1, 7], type='o')
abline(lm(coefVals[, 1, 7] ~ coefVals[, 4, 7]))
  
plot(coefVals[, 4, 8], coefVals[, 1, 8], type='o')
abline(lm(coefVals[, 1, 8] ~ coefVals[, 4, 8]))

# Set margins
par( mfrow = c(2, 2))

plot(coefVals[, 4, 9], coefVals[, 1, 9], type='o')
abline(lm(coefVals[, 1, 9] ~ coefVals[, 4, 9]))
  
plot(coefVals[, 4, 10], coefVals[, 1, 10], type='o')
abline(lm(coefVals[, 1, 10] ~ coefVals[, 4, 10]))

```

# X3 Coeffcient Difference Plots
```{r, echo=FALSE}
# Plot accuracy of coeffcients
# Set margins
par( mfrow = c(2, 2))
plot(coefVals[,4, 1], coefVals[,3, 1], type='o')
abline(lm(coefVals[, 3, 1] ~ coefVals[, 4, 1]))

```
From the plots, it appears that the model coeffceints are somewhat accrurate. Now lets look at how the precision changes.

```{r}
"
coefVals = matrix(NA, nrow=numMat, ncol=3, dimnames=list(1:numMat,c('x1_dif', 'x2_dif', 'x3_dif')))
for(i in 1:numMat) {
  model = glm(y ~ x1 + x2 + x3, data = as.data.frame(resultsArray[,,i]))
  coefVals[i,] = coef(model)[2:4] 
  
}

coefVals[,1] = abs(2 - coefVals[,1])
coefVals[,2] = abs(1 - coefVals[,2])
coefVals[,3] = abs(3 - coefVals[,3])
coefVals = cbind(coefVals, spat_range)

# Plot precision
par(mfrow=c(2,2))
plot(coefVals[,4], coefVals[,1], type='o')
abline(lm(coefVals[,1] ~ coefVals[,4]))


plot(coefVals[,4], coefVals[,2], type='o')
abline(lm(coefVals[,2] ~ coefVals[,4]))

plot(coefVals[,4], coefVals[,3], type='o')
abline(lm(coefVals[,3] ~ coefVals[,4]))
"

```